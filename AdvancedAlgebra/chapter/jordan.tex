

\section{From a Space Decomposition Perspective}

\subsection{Cyclic Invariant Subspace Decomposition}

\begin{lemma}{Nilpotent Basis}{}
  If $\mathcal{A}$ is a nilpotent transformation,
  for any vector $\alpha$,
  if $\mathcal{A}^{k-1} \alpha \neq 0$,
  then
  \begin{equation}
    \alpha, \mathcal{A}\alpha,\cdots,\mathcal{A}^{k-1}\alpha
  \end{equation}
  are linearly independent.
\end{lemma}

\begin{definition}{Cyclic Invariant Subspace}{}
  Let $\mathcal{A}$ be a nilpotent transformation on linear space $V$,
  for any vector $\alpha \in V$ satisfying $\mathcal{A}^k \alpha = 0,
  \mathcal{A}^{k-1}\alpha \neq 0$,
  then we call
  \begin{equation}
    I(\alpha) := \operatorname{span}(\alpha, \mathcal{A}\alpha, \cdots, \mathcal{A}^{k-1}\alpha)
  \end{equation}
  the \emph{cyclic invariant subspace}.
\end{definition}

\begin{theorem}{Cyclic Invariant Subspace Decomposition}{}
  For a nilpotent transformation $\mathcal{A}$ in $V$,
  there exist vectors $v_1,\cdots,v_n \in V$ and positive integers
  $m_1,\cdots,m_n$ such that
  \begin{equation}
    V = I(v_1) \oplus I(v_2) \oplus \cdots \oplus I(v_n).
  \end{equation}
  Here, $I(v_i) = \operatorname{span}(v_i, \mathcal{A} v_i, \cdots,
  \mathcal{A}^{m_i - 1}v_i)$ and $\mathcal{A}^{m_i}v_i = 0$.
\end{theorem}

\subsection{Generalized Eigenspace Decomposition}

\begin{definition}{Generalized Eigenvector and Generalized Eigenspace}{}
  Let $\mathcal{A}$ be a linear transformation in $V$,
  and let $\lambda$ be an eigenvalue of $\mathcal{A}$.
  For a vector $v \in V$, if there exists a positive integer $j$ such that
  \begin{equation}
    (\mathcal{A} - \lambda \mathcal{I})^j v = 0,
  \end{equation}
  then $v$ is called a \emph{generalized eigenvector of $\mathcal{A}$}.
  All generalized eigenvector of $\lambda$ togather with the zero vector $0$ form
  the \emph{generalized eigenspace}, denoted as $G_{\lambda}$.
\end{definition}

\begin{lemma}{Another Representation of Generalized Eigenspace}{}
  Let $\mathcal{A}$ be a linear transformation in $n$-dimensional linear space
  $V$, then the generalized eigenspace can be expressed as
  \begin{equation}
    G_{\lambda} = \operatorname{Ker} (\mathcal{A} - \lambda \mathcal{I})^{n}.
  \end{equation}
\end{lemma}

\begin{theorem}{Generalized Eigenspace Decomposition}{}
  Let $\mathcal{A}$ be a linear transformation in $n$-dimensional linear space
  $V$ over $\mathbb{C}$,
  and $\lambda_1,\cdots,\lambda_m$ be eigenvalues of $\mathcal{A}$.
  Then we have
  \begin{equation}
    V = G_{\lambda_1} \oplus G_{\lambda_2} \oplus \cdots \oplus G_{\lambda_m}.
  \end{equation}
\end{theorem}

\subsection{Jordan Canonical Form: Space Decomposition Perspective}

\begin{theorem}{Jordan Canonical Form: Space Decomposition Perspective}{}
  Let $\mathcal{A}$ be a linear transformation in an $n$-dimensional linear
  space $V$ over $\mathbb{C}$.
  Then there exists a basis such that the matrix of $\mathcal{A}$ under this
  basis has the form of
  \begin{equation}
    J=\left[\begin{matrix}
      J_1 && & 0 \\
      & J_2 && \\
      && \vdots & \\
      0 && & J_s
    \end{matrix}\right],\quad
      J_i=\begin{bmatrix}
      \lambda_i & 1 && 0 \\
      & \lambda_i & \ddots & \\
      && \ddots & 1 \\
      0 && & \lambda_i
    \end{bmatrix}_{n_i\times n_i}
  \end{equation}
\end{theorem}

\section{From a Minimal Polynomial Perspective}


\begin{theorem}{Kernel Space Decomposition}{}
  Let $\mathcal{A}$ be a linear transformation,
  and $f(x) = f_1(x) f_2(x)$ be a polynomial,
  where $(f_1(x), f_2(x)) = 1$.
  Then we have
  \begin{equation}
    \operatorname{Ker}(f(\mathcal{A}))
    = \operatorname{Ker}(f_1(\mathcal{A})) \oplus \operatorname{Ker}(f_2(\mathcal{A})).
  \end{equation}
\end{theorem}

\begin{proof}
  Since $f_1(x), f_2(x)$ are relatively prime, then there exist $u(x), v(x)$
  such that $u(x)f_1(x) + v(x)f_2(x) = 1$, that is
  \begin{equation}
    \mathcal{I} = u(\mathcal{A}) f_1(\mathcal{A}) + v(\mathcal{A}) f_2(\mathcal{A}).
  \end{equation}
  Then for any $\alpha \in \operatorname{Ker}(f(\mathcal{A}))$,
  $\alpha = u(\mathcal{A})f_1(\mathcal{A})\alpha +
  v(\mathcal{A})f_2(\mathcal{A})\alpha := \alpha_1 + \alpha_2$.
  We get
  \begin{equation}
    f_2(\mathcal{A}) \alpha_1 = u(\mathcal{A})f(\mathcal{A})\alpha = 0 \Rightarrow
    \alpha_1 \in \operatorname{Ker}(f_1(\mathcal{A})),
  \end{equation}
  Similarly we get $\alpha_2 \in \operatorname{Ker}(f_2(\mathcal{A}))$, and thus
  $\operatorname{Ker}(f(\mathcal{A})) = \operatorname{Ker}(f_1(\mathcal{A}))
  + \operatorname{Ker}(f_2(\mathcal{A}))$.
  Next, we prove that it is direct sum. For any $\alpha \in
  \operatorname{Ker}(f_1(\mathcal{A})) + \operatorname{Ker}(f_2(\mathcal{A}))$,
  we have
  \begin{equation}
    \alpha = u(\mathcal{A})f_1(\mathcal{A})\alpha + v(\mathcal{A}) f_2(\mathcal{A})\alpha = 0,
  \end{equation}
  which satisfies the condition for direct sum.
\end{proof}

\begin{lemma}{Kernel Space of the Zero Transformation}{}
  Let $V$ be a linear space over $\mathbb{P}$,
  and $\mathcal{O}$ be the zero transformation.
  Then its kernel space is the entire space
  \begin{equation}
    \operatorname{Ker}(\mathcal{O}) = V.
  \end{equation}
\end{lemma}

\begin{theorem}{Generalized Eigenspace Decomposition: Polynomial Perspective}{}
  Let $\mathcal{A}$ be a linear transformation in $V$ over $\mathbb{C}$,
  with its characteristic polynomial and minimal polynomial be
  \begin{equation}
    f(\lambda) = (\lambda - \lambda_1)^{k_1} \cdots (\lambda - \lambda_s)^{k_s}, \quad
    m(\lambda) = (\lambda - \lambda_1)^{\ell_1} \cdots (\lambda - \lambda_s)^{\ell_s},
  \end{equation}
  respectively. Then we have the following space decomposition
  \begin{equation}
    V = \operatorname{Ker} (\mathcal{A} - \lambda_1 \mathcal{I})^{k_1} \oplus
    \cdots \oplus \operatorname{Ker}(\mathcal{A} - \lambda_s \mathcal{I})^{k_s}
    = \operatorname{Ker}(\mathcal{A} - \lambda_1 \mathcal{I})^{\ell_1} \oplus
    \cdots \oplus \operatorname{Ker}(\mathcal{A} - \lambda_s \mathcal{I})^{\ell_s}
  \end{equation}
\end{theorem}

\section{$\lambda$ Matrices}

\subsection{Concept of $\lambda$ Matrices}

\begin{definition}{$\lambda$-Matrix}{}
  If $A(\lambda)$ is a matrix whose elements are polynomials in $\lambda$,
  then it is called a \emph{$\lambda$-matrix}.
\end{definition}

\begin{definition}{Elementary Operations of $\lambda$-Matrices}{}
  There are three types of elementary transformations for $\lambda$-matrices:
  \begin{enumerate}
  \item Interchange two rows/columns;
  \item Multiply a row/column by a non-zero constant (cannot multiply by a $\lambda$-polynomial!);
  \item Add a $\lambda$-polynomial of one row/column to another row/column.
  \end{enumerate}
\end{definition}

\begin{definition}{Equivalence between $\lambda$-Matrices}{}
  If one $\lambda$-matrix can be transformed into another $\lambda$-matrix
  by elementary operations, then the two $\lambda$-matrices are said to be
  \emph{equivalent}.
\end{definition}

\begin{theorem}{Smith Normal Form}{}
  For a matrix $A$, $\lambda I - A$ is always equivalent to
  \begin{equation}
    D = \operatorname{diag}\{1, \cdots, 1, d_1(\lambda), \cdots, d_m(\lambda)\},
  \end{equation}
  where $d_i(\lambda)$ is a monic polynomial, satisfying
  $d_i(\lambda)|d_{i+1}(\lambda)$.
\end{theorem}

\begin{proposition}{Calculation of Smith Normal Form}{}
  Find the Smith normal form using the following steps: For the $i$-th step,
  \begin{enumerate}
  \item Move the entry with the lowest degree to the corner;
  \item Consider the $i$-th row and column, if there exists $a_{ij}(\lambda)$ such that
    $a_{ii}(\lambda)$ does not divide $a_{ij}(\lambda)$,
    perform $a_{ij}(\lambda) = q(\lambda)a_{ii}(\lambda) + r(\lambda)$
    and interchange the $i$-th and $j$-th column.
  \item Consider the remaining entries, if there exists $a_{kl}(\lambda)$ such that
    $a_{ii}$ does not divide $a_{kl}(\lambda)$, then add the $i$-th column by
    the $l$-th column, repeat the second step.
  \end{enumerate}
\end{proposition}

\begin{example}{Find the Smith Normal Form}{}
  Find the Smith normal form of $\lambda I - A$:
  \begin{equation}
    A =
    \begin{bmatrix}
      -1 & 1 & 3\\
      3 & 0 & -4\\
      -2 & 1 & 4
    \end{bmatrix}
  \end{equation}
\end{example}

\begin{solution}
  We first calculate $\lambda I - A$:
  \begin{align}
    \lambda I - A
    &=
    \begin{bmatrix}
      \lambda + 1 & -1 & -3\\
      -3 & \lambda & 4\\
      2 & -1 & \lambda - 4
    \end{bmatrix}
    \rightarrow 
    \begin{bmatrix}
      - 1 & \lambda + 1 & -3\\
      \lambda & -3 & 4\\
      - 1 & 2 & \lambda - 4
    \end{bmatrix}
    \rightarrow
    \begin{bmatrix}
      1 & 0 & 0\\
      0 & \lambda^2+\lambda-3 & 4-3\lambda\\
      0 & 1-\lambda & \lambda -1
    \end{bmatrix}\\
    &\rightarrow
    \begin{bmatrix}
      1 & 0 & 0\\
      0 & 1-\lambda & \lambda-1\\
      0 & \lambda^2 + \lambda - 3 & 4 - 3\lambda
    \end{bmatrix}
      \rightarrow
    \begin{bmatrix}
      1 & 0 & 0\\
      0 & \lambda-1 & 0\\
      0 & -1 & (\lambda-1)^2
    \end{bmatrix}
      \rightarrow
    \begin{bmatrix}
      1 & 0 & 0\\
      0 & 1 & -(\lambda - 1)^2\\
      0 & \lambda-1 & 0
    \end{bmatrix}\\
    &\rightarrow
    \begin{bmatrix}
      1 & 0 & 0\\
      0 & 1 & 0\\
      0 & 0 & (\lambda-1)^3
    \end{bmatrix}
  \end{align}
  Thus the Smith normal form of $\lambda I - A$ is $\operatorname{diag}\{1, 1,
  (\lambda - 1)^3\}$.
\end{solution}

\subsection{Determinant Divisors, Invariant Factors, and Elementary Divisors}

\begin{definition}{Determinant Divisor}{}
  Let $A(\lambda)$ be a $\lambda$-matrix. If the determinants of all $k$-minors
  of $A$ are $0$, then its \emph{$k$-th determinant divisor} is zero.
  Otherwise, it is defined as the monic common divisor of all non-zero $k$-minors.
\end{definition}

\begin{definition}{Invariant Factors}{}
  Let $D_1(\lambda), \cdots, D_n(\lambda)$ be the determinant divisors of
  $A(\lambda)$,
  then define
  \begin{equation}
    d_i(\lambda) =
    \begin{cases}
      D_i(\lambda) & i = 1;\\
      D_i(\lambda)/D_{i-1}(\lambda) & i = 2,\cdots,n,
    \end{cases}
  \end{equation}
  and we call them the \emph{invariant factors of $A(\lambda)$}.
\end{definition}

\begin{example}{Find the Invariant Factors via Determinant Divisor}{}
  Find the Invariant Factors of
  \begin{equation}
    A = \begin{bmatrix}&&1&\lambda+2\\&1&\lambda+2\\1&\lambda+2\\\lambda+2\end{bmatrix}.
  \end{equation}
\end{example}

\begin{solution}
  (1) $D_n(\lambda) = (\lambda + 2)^4$,
  the left top minor is $-1$, thus the invariant factors are $1, 1, 1, (\lambda
  + 2)^4$.
\end{solution}

\begin{example}{Determinant Divisor and Jordan Canonical Form}{}
  Let $a, b$ be complex numbers, find the Jordan canonical form of
  \begin{equation}
    A =
    \begin{bmatrix}
      a & b & \cdots & b & b\\
        & a & \cdots & b & b\\
        &   & \ddots & \vdots & \vdots\\
        &   &        & a & b\\
        &   &        &   & a
    \end{bmatrix}
  \end{equation}
\end{example}

\begin{solution}
  If $b = 0$, then the Jordan canonical form is $a I$.
  Otherwise, consider $\lambda I - A$:
  \begin{equation}
    \lambda I-A=\begin{bmatrix}\lambda-a&-b&\cdots&-b&-b\\&\lambda-a&\cdots&-b&-b\\&&\ddots&\vdots&\vdots\\&&&\lambda-a&-b\\&&&&\lambda-a\end{bmatrix}
  \end{equation}
  $D_n(\lambda) = |\lambda I - A| = (\lambda - a)^n$.
  Consider $D_{n-1}(\lambda)$, the right bottem minor is $(\lambda - a)^{n-1}$,
  but the right top minor is not zero when $\lambda = a$.
  This means $D_{n-1}(\lambda) = 1$.
  Then the elementary divisors of $A$ is $(\lambda - a)^n$,
  and the Jordan canonical form is an $n$-order Jordan block with $a$ on its diagonal.
\end{solution}

\begin{proposition}{Invariant Factors and Minimal Polynomial}{}
  The minimal polynomial of $A$ is the last invariant factor of $\lambda I - A$.
\end{proposition}

\begin{definition}{Elementary Divisors}{}
  Any irreducible polynomial $p(\lambda)$
  obtained from factorizing all the invariant factors of $A(\lambda)$ is called
  an \emph{elementary divisor of $A(\lambda)$}.
\end{definition}

\begin{proposition}{Calculating Elementary Divisors by Diagonalization}{}
  If the $\lambda$-matrix $\lambda I - A$ can be transformed into
  the following diagonal matrix (not necessarily in Smith form) through elementary transformations
  \begin{equation}
    \begin{pmatrix}
      f_1(\lambda) & & &\\
                   &f_2(\lambda) & &\\
                   & &\ddots &\\
                   & & &f_n(\lambda)
    \end{pmatrix},
  \end{equation}
  where $f_i(\lambda)$ are non-zero monic polynomials.
  Then the elementary divisors of $A$ are the irreducible factorizations of all $f_i(\lambda)$.
\end{proposition}

\begin{proposition}{Find Jordan Canonical Form via Elementary Divisors}{}
  If a matrix $A$ over $\mathbb{P}$ has a set of elementary divisors
  $(\lambda - \lambda_1)^{r_1},\cdots,(\lambda - \lambda_k)^{r_k}$, then
  \begin{equation}
    J = \operatorname{diag}(J_1, \cdots, J_k),
  \end{equation}
  where $J_i$ is an $r_i$-order Jordan block with $\lambda_i$ on the diagonal.
\end{proposition}

\begin{example}{Find the Elementary Divisors and Jordan Canonical Form}{}
  Find the elementary divisors and Jordan canonical form of $A$:
  \begin{equation}
    A =
    \begin{bmatrix}
      1 & -1 & 2\\
      3 & -3 & 6\\
      2 & -2 & 4
    \end{bmatrix}.
  \end{equation}
\end{example}

\begin{example}{Calculation of Jordan Canonical Form and Transition Matrix}{}
  Given the following matrix $A$, find the Jordan canonical form $J$,
  and the transition matrix $P$ such that $P^{-1}AP = J$:
  \begin{equation}
    A =
    \begin{bmatrix}
      2 & 3 & 2\\
      1 & 8 & 2\\
      -2 & -14 & -3
    \end{bmatrix}.
  \end{equation}
\end{example}

\begin{solution}
  We use elementary row operations to find the Jordan canonical form,
  consider $\lambda I - A$:
  \begin{align}
    \lambda I - A &=
    \begin{bmatrix}
      \lambda - 2 & -3 & -2\\
      -1 & \lambda - 8 & -2\\
      2 & 14 & \lambda + 3
    \end{bmatrix}
    \rightarrow
    \begin{bmatrix}
      -1 & \lambda - 8 & -2\\
      \lambda - 2 & -3 & -2\\
      2 & 14 & \lambda + 3
    \end{bmatrix}
    \rightarrow
    \begin{bmatrix}
      1 & 0 & 0\\
      0 & \lambda^2 - 10\lambda + 13 & -2\lambda + 2\\
      0 & 2\lambda - 2 & \lambda-1
    \end{bmatrix}\\
    &\rightarrow
    \begin{bmatrix}
      1 & 0 & 0\\
      0 & \lambda-1 & 2\lambda-2\\
      0 & -2\lambda+2 & \lambda^2-10\lambda + 13
    \end{bmatrix}
      \rightarrow 
    \begin{bmatrix}
      1 & 0 & 0\\
      0 & \lambda-1 & 0\\
      0 & 0 & (\lambda-3)^2
    \end{bmatrix}.
  \end{align}
  The elementary divisors are $(\lambda-1), (\lambda-3)^2$, then the
  Jordan canonical form is
  \begin{equation}
    J =
    \begin{bmatrix}
      1 & & \\
        & 3 & 1\\
        & & 3
    \end{bmatrix}
  \end{equation}
  Now we find the transition matrix $P$. First, we consider the second Jordan
  block $J_2$. Assume $P_2 = [x_2, x_3]$, since $AP = PJ$, we know
  \begin{equation}
    Ax_2 = 3x_2, Ax_3 = 3x_3 + x_2
    \Rightarrow (A - 3I)x_2 = 0, (A - 3I)x_3 = x_2.
  \end{equation}
  Consider the first system of linear equations,
  \begin{equation}
    (A - 3I) =
    \begin{bmatrix}
      -1 & 3 & 2\\
      1 & 5 & 2\\
      -2 & -14 & -6
    \end{bmatrix}
    \rightarrow
    \begin{bmatrix}
     - 1 & 3 & 2\\
      0 & 2 & 1\\
      0 & 0 & 0
    \end{bmatrix}
    \Rightarrow
    x_2 = k
    \begin{pmatrix}
      1\\
      -1\\
      2
    \end{pmatrix}.
  \end{equation}
  Let $x_2 = (1, -1, 2)^T$, and consider the second system of linear equations
  \begin{equation}
    [A - 3I|x_2] = 
    \begin{bmatrix}
      -1 & 3 & 2 & 1\\
      1 & 5 & 2 & -1\\
      -2 & -14 & -6 & 2
    \end{bmatrix}
    \rightarrow
    \begin{bmatrix}
      -1 & 3 & 2 & 1\\
      0 & 2 & 1 & 0\\
      0 & 0 & 0 & 0
    \end{bmatrix}
    \Rightarrow
    x_2 =
    \begin{pmatrix}
      -1\\0\\0
    \end{pmatrix}
    + k
    \begin{pmatrix}
      1\\-1\\2
    \end{pmatrix},
  \end{equation}
  we can choose $x_3 = (-1, 0, 0)^T$.
  Now consider $(A - I) x = 0$,
  \begin{equation}
    A - I =
    \begin{bmatrix}
      1 & 3 & 2\\
      1 & 7 & 2\\
      -2 & -14 & -4
    \end{bmatrix}
    \rightarrow
    \begin{bmatrix}
      1 & 0 & 2\\
      0 & 1 & 0\\
      0 & 0 & 0
    \end{bmatrix},
  \end{equation}
  we can choose $x_1 = (-2, 0, 1)^T$.
  Then $P = [x_1, x_2, x_3]$.
\end{solution}

