

\section{Lebesgue Integral}

\subsection{Integral of Non-Negative Simple Functions}

\begin{definition}{Characteristic Function}{}
  Let $X$ be a set, and let $E \subset X$.
  The \emph{characteristic function of $E$} is
  \begin{equation}
    \chi_E(x) :=
    \begin{cases}
      1 & \text{if } x \in E;\\
      0 & \text{if } x \not \in E.
    \end{cases}
  \end{equation}
\end{definition}

\begin{example}{Application of Characteristic Function}{}
  $m (E) \neq 0$, $f \in L(E)$, for any measurable function $\varphi(x)$,
  $\int_E f(x)\varphi(x)\mathrm{d} x = 0$. Prove that $f(x) = 0$ a.e. in $E$.
\end{example}

\begin{proof}
  For any $n \in \mathbb{Z}^+$. Define $E_n := \{x \in E: f(x) \geq \frac{1}{n}\}$.
  Then
  \begin{equation}
    0 \leq \frac{1}{n} m(E_n) \leq \int_{E_n} f(x)\mathrm{d} x = \int_E \chi_{E_n}(x) f(x)\mathrm{d} x = 0,
  \end{equation}
  thus $m(E_n) = 0$.
  We get $m(\{f > 0\}) = m(\cup_{n=1}^{+\infty} E_n) = 0$, similarly we can prove $m(\{f < 0\}) = 0$.
\end{proof}

\begin{definition}{Lebesgue Integral of Non-Negative Simple Functions}{}
  Let $f = \sum _{i = 1}^s a_i \chi_{E_i}(x)$ be a simple function,
  then \emph{Lebesgue integral of $f$} over $D = \cup _{i = 1}^s E_i$ is
  \begin{equation}
    \int_D f(x)\mathrm{d} x = \sum\limits_{i = 1}^s a_i m(E_i).
  \end{equation}
\end{definition}

\begin{example}{Practice on Lebesgue Integral of Non-Negative Simple Functions}{}
  \begin{enumerate}
  \item Let $C$ be the Cantor set in $[0, 1]$,
    $f(x) = 0$ for $x \in C$, $f(x) = n$ for $x \in D_n$,
    where $D_n$ is a subset in $[0, 1] - C$ with length $3^{-n}$.
    Prove that $f(x) \in L([0, 1])$ and compute $\int_0^1 f(x)\mathrm{d} x$.
  \end{enumerate}
\end{example}

\begin{solution}
  (1) According to the definition of Cantor set,
  the number of intervals in $[0, 1] - C$ with length $3^{-n}$ is $2^{n-1}$.
  Then the definition of Lebesgue integral for non-negative simple functions yields
  \begin{equation}
    \int_0^1 f(x)\mathrm{d} x
    = \sum\limits_{n = 1}^{\infty} 2^{n-1} \cdot n \cdot 3^{-n}
    = \sum\limits_{n = 1}^{\infty} \left( \frac{2}{3} \right)^n \frac{n}{2}
    := S_n.
  \end{equation}
  Consider $\frac{2}{3}S_n = \sum\limits_{n = 2}^{\infty} (\frac{2}{3})^n
  \frac{n-1}{2}$, then
  \begin{equation}
    \frac{1}{3}S_n = \frac{1}{3} + \sum\limits_{n = 2}^{\infty} \left( \frac{2}{3} \right)^n \frac{1}{2}
    = 1.
  \end{equation}
  This means $S_n = 3$, and the lebesgue integral is $3$.
\end{solution}

\subsection{Integral of Non-negative Measurable Functions}

\begin{definition}{Lebesgue Integral of Non-negative Measurable Function}{}
  Let $f$ be a non-negative measurable function on a measurable set $D$,
  $f_n$ be a sequence of non-negative simple functions that increasingly
  converges to $f$ for each $x \in D$.
  Then the \emph{Lebesgue integral of $f$ on $D$} is
  \begin{equation}
    \int_D f \mathrm{d} x= \lim \limits _{n \rightarrow \infty} \int_D f_n \mathrm{d} x.
  \end{equation}
\end{definition}

\begin{example}{Practice on Lebesgue Integral of Non-Negative Measurable Functions}{}
  Let $\{f_n\}$ be non-negative measurable functions,
  $\lim \limits _{n \rightarrow \infty} \int_E f_n(x)\mathrm{d} x = 0$.
  Prove that $f_n(x) \measconv 0$.
\end{example}

\begin{proof}
  Denote $E_{\sigma} := \{x \in E: f_n(x) \geq \sigma\}$, then we have
  \begin{equation}
    \int_{E_{\sigma}}f_n(x)\mathrm{d} x \geq \sigma \cdot m (E_{\sigma}), \quad
    \int_{E_{\sigma}}f_n(x) \mathrm{d} x \leq \int_E f_n(x) \mathrm{d} x.
  \end{equation}
  Combine the above two equations, we have
  \begin{equation}
    m(E_{\sigma}) \leq \frac{1}{\sigma} \int_E f_n(x)\mathrm{d} x \rightarrow 0,
  \end{equation}
  then $f_n(x) \measconv 0$.
\end{proof}

\begin{theorem}{Levi's Monotone Convergence Theorem}{}
  Let $f$ and $f_n$ be non-negative measurable functions on a measurable set
  $D$.
  If for any $x \in D$, $f_n(x) \aeconv f(x)$ non-decreasingly, then
  \begin{equation}
    \int_D f(x)\mathrm{d} x = \lim \limits _{n \rightarrow \infty} \int_D f_n\mathrm{d} x.
  \end{equation}
\end{theorem}

\begin{theorem}{Fatou Theorem}{}
  Let $f_n$ be non-negative measurable functions on a measurable set $D$,
  then
  \begin{equation}
    \int_D \liminf \limits_{n \rightarrow \infty} f_n\mathrm{d} x
    \leq \liminf \limits_{n \rightarrow \infty} \int_D f_n\mathrm{d} x.
  \end{equation}
\end{theorem}

\begin{example}{Applications of Fatou Theorem}{}
  Let $\{f_n(x)\}$ be measurable functions, $\lim \limits _{n \rightarrow \infty} f_n(x) = f(x)$ a.e.
  Prove that there exists $K$ such that $\int_E |f_n(x)| \mathrm{d} x \leq K$.
\end{example}

\begin{proof}
  Since $\lim \limits _{n \rightarrow \infty} f_n(x) = f(x)$ a.e.,
  $\lim \limits _{n \rightarrow \infty} |f_n(x)| = f(x)$ a.e.
  Consider the Lebesgue integral of $|f(x)|$, by Fatou theorem
  \begin{equation}
    \int_E |f(x)|\mathrm{d} x = \int_E \lim \limits _{n \rightarrow \infty} |f_n(x)| \mathrm{d} x
    \leq \lim \limits _{n \rightarrow \infty} \int_E |f_n(x)|\mathrm{d} x \leq K < +\infty.
  \end{equation}
\end{proof}

\subsection{Integral of Normal Measurable Functions}

\begin{definition}{Lebesgue Integral}{}
  Let $f$ be a measurable function on a measurable set $D$,
  and $f_+(x) := \max\{0, f(x)\}$, $f_-(x) := \max\{0, -f(x)\}$.
  Then the \emph{lebesgue integral of $f$ over $D$} is
  \begin{equation}
    \int_D f \mathrm{d} x 
    = \int_D f_+ \mathrm{d} x - \int_D f_-\mathrm{d} x
    := I^+ - I^-.
  \end{equation}
  If $I^+, I^- < +\infty$, then $f$ is said to be \emph{lebesgue integrable over
    $D$}, denoted as $f \in L(D)$.
\end{definition}

\begin{note}
  A measurable function $f$ is Lebesgue integrable if and only if $|f|$
  is Lebesgue integrable.
\end{note}

\begin{example}{Practice on Lebesgue Integral of Normal Measurable Functions}{}
  Let $E$ be a measurable set with finite measure, and $f$ be a measurable function.
  Define $E_n = \{n - 1 \leq f < n\}$, where $n \in \mathbb{Z}$.
  Prove that $f$ is Lebesgue integrable if and only if
  \begin{equation}
    \sum\limits_{- \infty}^{+\infty} |n| \cdot m(E_n) < +\infty.
  \end{equation}
\end{example}

\begin{proof}
  When $n \geq 1$, according to the definition of Lebesgue integral,
  \begin{equation}
    |n| \cdot m(E_n) = \int_{E_n} n \mathrm{d} x \geq \int_{E_n} |f(x)| \mathrm{d}x
    > |n-1| \cdot m(E_n).
  \end{equation}
  Similarly, when $n < 1$,
  \begin{equation}
    |n - 1| \cdot m(E_n) = (1-n) \cdot m(E_n) \geq \int_{E_n} |f(x)|\mathrm{d}x
    > |n|\cdot m(E_n).
  \end{equation}

  Since $f$ is Lebesgue integrable, then $|f|$ is integrable,
  \begin{align}
    +\infty > \int_E |f|\mathrm{d} x
    &= \sum\limits_{n = 1}^{+\infty} \int_{E_n} |f|\mathrm{d}x + \sum\limits_{n = 0}^{-\infty} \int_{E_n}|f|\mathrm{d}x\\
    &> \sum\limits_{n = 1}^{+\infty} |n-1| \cdot m(E_n)
    + \sum\limits_{n = 0}^{-\infty} |n| \cdot m(E_n)\\
    &= \sum\limits_{n = -\infty}^{+\infty} |n| \cdot m(E_n) - \sum\limits_{n = 1}^{+\infty} m(E_n),
  \end{align}
  here, $\sum\limits_{n = 1}^{\infty} m(E_n) = m(\{f \geq 1\}) < \infty$.
  Therefore the conclusion holds.
\end{proof}


\begin{theorem}{Countable Additivity of the Lebesgue Integral}{}
  Let $f$ be Lebesgue integrable over $D$,
  and $\{E_k\}$ be a partition of $D$. Then
  \begin{equation}
    \int_D f \mathrm{d} x = \sum\limits_{k = 1}^{\infty} \int_{E_k} f \mathrm{d} x.
  \end{equation}
\end{theorem}

\begin{theorem}{Absolute Continuity of the Lebesgue Integral}{}
  Let $f$ be Lebesgue integrable over $D$,
  then
  \begin{equation}
    \forall \epsilon > 0, \exists \delta > 0, \forall A \subset D,
    m(A) < \delta, \left| \int_A f \mathrm{d} x \right| < \epsilon.
  \end{equation}
\end{theorem}

\begin{example}{Applications of Absolute Continuity of the Lebesgue Integral}{}
  Let $E$ be a measurable set, $f \in L(E)$, $e_n := \{|f| \geq n\}$,
  prove that $\lim \limits _{n \rightarrow \infty} n \cdot m(e_n) = 0$.
\end{example}

\begin{proof}
  According to the definition of Lebesgue integral of non-negative simple
  functions we have
  \begin{equation}
    n \cdot m(e_n) = \int_{e_n} n \mathrm{d} x \leq \int_{e_n} |f(x)|\mathrm{d} x.
  \end{equation}
  It is not hard to see that $e_n$ is monotonically decreasing,
  and since $f$ is finite a.e., then
  \begin{equation}
    m(\lim \limits _{n \rightarrow \infty} e_n)
    = m(\lim \limits _{n \rightarrow \infty} \{|f| \geq n\}) = 0
  \end{equation}
  which means $\forall \delta > 0, \exists N > 0, \forall n > N$, $m(e_n) < \delta$.
  Then according to the absolute continuity of Lebesgue integral
  \begin{equation}
    \forall \epsilon > 0, \exists \delta > 0, \exists A \subset E, m(A) < \delta,
    \int_A |f(x)|\mathrm{d} x < \epsilon.
  \end{equation}
  Combining the above two equations yields $n\cdot m(e_n) < \epsilon$,
  so it converges to $0$.
\end{proof}

\begin{theorem}{Lebesgue's Dominated Convergence Theorem (LDCT)}{}
  Let $f$ and $f_n$ be measurable functions on a measurable set $D$.
  If $f_n(x) \aeconv f(x)$ and there exists $g \in L(D)$,
  $|f_n(x)| \leq g(x)$ a.e. for any $n \geq 1$.
  Then $f, f_n \in L(D)$,
  \begin{equation}
    \lim \limits _{n \rightarrow \infty} \int_D f_n\mathrm{d} x
    = \int_D f\mathrm{d}x.
  \end{equation}
\end{theorem}

\begin{example}{Applications of LDCT}{}
  
\end{example}

\section{Riemann Integral}

\begin{theorem}{Condition for Riemann Integral}{}
  Let $f(x)$ be a bounded function on $[a, b]$.
  Then $f(x)$ is Riemann integrable if and only if
  it is continuous a.e. on $[a, b]$.
\end{theorem}

\begin{example}{Application of Condition for Riemann Integral}{}
  If $f(x) \in R[a, b]$, $g(x)$ be continuous on $\mathbb{R}$,
  prove that $g(f(x)) \in R[a, b]$.
\end{example}

\begin{proof}
  Denote the set of non-continuous points of $f(x)$ as $E$.
  Then
  \begin{equation}
    \forall x_0 \in [a, b] - E, \lim \limits _{x \rightarrow x_0} f(x) = f(x_0) = y_0.
  \end{equation}
  $\lim \limits _{x \rightarrow x_0}g(f(x)) = \lim \limits _{y \rightarrow y_0}g(y) = g(y_0)$,
  this means $g(f(x))$ is continuous a.e. on $[a, b]$.
\end{proof}

\begin{theorem}{Riemann Integral and Lebesgue Integral}{}
  If $f(x)$ is Riemann integrable, then it is Lebesgue integrable,
  and the value of the integrals are the same.
\end{theorem}

\begin{example}{Relation between Lebesgue Integral and Riemann Integral}{}
  Let $a$ be the only singularity of $f$ on $(a, b]$,
  the improper integral $\int_a^b f(x)\mathrm{d} x$ converges.
  Prove that $f \in L[a, b]$ if and only if $|f| \in R[a, b]$,
  and 
  \begin{equation}
    \int_{[a,b]} f(x)\mathrm{d} x = \int_a^b f(x)\mathrm{d} x.
  \end{equation}
\end{example}

\begin{proof}
  For any $\{a_n\}$ that $\lim \limits _{n \rightarrow \infty} a_n = a$,
  definition of improper integral indicates
  $\lim \limits _{n \rightarrow \infty} \int_{a_n}^b f(x)\mathrm{d} x = \int_a^b f(x)\mathrm{d} x$.
  Then
  \begin{equation}
    \int_{[a, b]} |f(x)|\mathrm{d} x = \lim \limits _{n \rightarrow \infty} \int_{[a_n, b]} |f(x)|\mathrm{d} x
    = \lim \limits _{n \rightarrow \infty} \int_{a_n}^b |f(x)|\mathrm{d} x = \int_a^b |f(x)| \mathrm{d} x.
  \end{equation}
  Since $f(x) \in L[a, b]$ if and only if $|f(x)| \in L[a, b]$, then we get $f \in L[a,b]$ if and only if $|f| \in R[a,b]$.
  Now we prove the integrals are equal,
  \begin{equation}
    \int_{[a,b]}f(x)\mathrm{d} x= \lim \limits _{c \rightarrow a^+} \int_{[c,b]}f(x)\mathrm{d} x
    = \lim \limits _{c \rightarrow a^+}\int_c^b f(x)\mathrm{d} x = \int_a^b f(x)\mathrm{d} x.
  \end{equation}
\end{proof}

\begin{note}
  The Riemann integrability of a function $f$ does not imply the Riemann integrability of $|f|$,
  and vice versa.
\end{note}

\section{Multiple Integral and Iterated Integral}

\begin{theorem}{Fubini Theorem}{}
  Let $f(x, y)$ be integrable over $\mathbb{R}^p \times \mathbb{R}^q$. Then
  for $x, y$ a.e., $f(x,y)$ is integrable with respect to both $y$ and $x$
  respectively,
  \begin{equation}
    \int_{\mathbb{R}^p \times \mathbb{R}^q} f(x,y)\mathrm{d} x\mathrm{d}y 
    = \int_{\mathbb{R}^p} \left[ \int_{\mathbb{R}^q} f(x,y)\mathrm{d} y \right]\mathrm{d} x.
  \end{equation}
\end{theorem}


